<!doctype html>
<html lang="en" class="h-100">
    <head>
        
        <title>
            
                SSH | Mutagen
            
        </title>

        
        <meta charset="utf-8">

        
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        
        <link rel="shortcut icon" href="/img/favicon.png">

        
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>

        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>

        
        <script src="/js/asciinema-player.js"></script>

        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mukta|Roboto:300,400|Roboto+Mono">

        
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

        
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

        
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

        
        <link rel="stylesheet" href="/css/asciinema-player.css">

        
        
        <link rel="stylesheet" href="https://mutagen.io/sass/mutagen.min.9b222dd1d84a63648b0e047c53c211c76c3ad36feaf7bed5889a943ebb9f573a.css" integrity="sha256-myIt0dhKY2SLDgR8U8IRx2w602/q977ViJqUPrufVzo=">

        
        <script type="text/javascript">
            
            $(function () {
                $('[data-toggle="tooltip"]').tooltip()
            });
        </script>
    </head>
    <body class="d-flex flex-column h-100">
        <div class="flex-shrink-0">
            <nav class="navbar navbar-light navbar-expand-md">
                <div class="container">
                    <a class="navbar-brand" href="/">
                        <img class="d-inline-block align-top mutagen-navbar-logo" src="/img/logo_thick_light.svg" alt="Mutagen logo">
                        Mutagen
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation-content" aria-controls="navigation-content" aria-expanded="false" aria-label="Toggle navigation">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="collapse navbar-collapse" id="navigation-content">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="/overview">Overview</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/documentation">Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/documentation/installation">Install</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="https://github.com/havoc-io/mutagen">Source</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

<div class="container">
    <nav class="pt-4 pb-1" aria-label="breadcrumb">
    <ol class="breadcrumb">
        
        
            
        
            
        
        
        <li class="breadcrumb-item">
            <a href="https://mutagen.io/documentation/">Documentation</a>
        
        </li>
    
        
        
        <li class="breadcrumb-item">
            <a href="https://mutagen.io/documentation/transports/">Transports</a>
        
        </li>
    
        
        
        <li class="breadcrumb-item active" aria-current="page">
            SSH
        
        </li>
    
    </ol>
    
</nav>
    <div class="row">
        <div class="d-none d-lg-block col-lg-4">
            <div class="sticky-top" style="top:40px;">
                <nav id="TableOfContents">
<ul>
<li><a href="#ssh">SSH</a>
<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#mechanism-of-action">Mechanism of action</a></li>
<li><a href="#overriding-the-openssh-executable-search-path">Overriding the OpenSSH executable search path</a></li>
<li><a href="#windows">Windows</a>
<ul>
<li><a href="#ssh-servers">SSH servers</a></li>
<li><a href="#putty">PuTTY</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
            </div>
        </div>
        <div class="col-md-12 col-lg-8 mb-3">
            

<h1 id="ssh">SSH</h1>

<p>Mutagen provides support for synchronizing with filesystem locations accessible
via SSH. This support extends to SSH clients and servers found on both POSIX and
Windows systems.</p>

<h2 id="requirements">Requirements</h2>

<p>Mutagen requires an OpenSSH client installation to be available on your system.
This is the default for almost all POSIX operating systems, so you probably
don&rsquo;t need to do anything if you&rsquo;re on macOS, Linux<sup>®</sup>, or one of the
BSDs. Windows is supported as well, but please see the
<a href="#windows">section on Windows support</a> for more detailed information.</p>

<p>Mutagen should support most SSH server implementations, so long as they support
OpenSSH&rsquo;s <code>scp</code> and <code>ssh</code> implementations. If you run into trouble with a
particular SSH server implementation, please file an issue.</p>

<h2 id="usage">Usage</h2>

<p>SSH synchronization endpoints can be specified to Mutagen&rsquo;s <code>create</code> command
using an SCP-like URL syntax of the form:</p>

<pre><code>[user@]host[:port]:path
</code></pre>

<p>The <code>user</code> component is optional and will be passed to OpenSSH to override the
default username.</p>

<p>The <code>host</code> component can be any IP address, hostname, or alias understood by
OpenSSH.</p>

<p>The <code>port</code> component is also optional and is an extension to the standard SCP
URL syntax. If specified, it will be passed to OpenSSH to override the default
port.</p>

<p>The <code>path</code> component is interpreted in the same way as an SCP path. It can be an
absolute path, e.g.</p>

<pre><code>user@host:/var/www
</code></pre>

<p>a relative path (in which case it&rsquo;s considered relative to the user&rsquo;s home
directory), e.g.</p>

<pre><code>user@host:path/in/home/directory
</code></pre>

<p>a home-directory-relative path, e.g.</p>

<pre><code>user@host:~/path/in/home/directory
</code></pre>

<p>or an alternate user home-directory-relative path, e.g.</p>

<pre><code>user@host:~otheruser/path/in/their/home/directory
</code></pre>

<p>The <code>path</code> component is not allowed to be empty.</p>

<h2 id="mechanism-of-action">Mechanism of action</h2>

<p>Mutagen&rsquo;s SSH support is provided by the OpenSSH installation on your system.
Mutagen uses the OpenSSH suite&rsquo;s <code>scp</code> command to copy agent binaries to remote
systems and the <code>ssh</code> command to run and communicate with the agent binaries
over standard input/output streams.</p>

<p>Mutagen redirects SSH prompts to its <code>create</code> and <code>resume</code> commands via the
<code>SSH_ASKPASS</code> environment variable.</p>

<p>This design has a number of advantages:</p>

<ul>
<li>OpenSSH installations are nearly universal in the POSIX world, and
<a href="https://blogs.msdn.microsoft.com/powershell/2017/12/15/using-the-openssh-beta-in-windows-10-fall-creators-update-and-windows-server-1709/">OpenSSH is now making its way to Windows</a>.</li>
<li>Mutagen automatically uses all existing SSH configuration, keys, and aliases.</li>
<li>There&rsquo;s no risk of baking in an SSH library that might be found to have
security vulnerabilities.</li>
<li>With OpenSSH being the <em>de facto</em> SSH implementation, other SSH server
implementations are far more likely to aim for compatibility with OpenSSH
clients.</li>
<li>OpenSSH has a much longer develoment and security track record than any SSH
library implementation.</li>
</ul>

<p>Mutagen may eventually support other SSH clients or embed the
<a href="https://godoc.org/golang.org/x/crypto/ssh">Go SSH library</a>, but these will
always be fallback options.</p>

<h2 id="overriding-the-openssh-executable-search-path">Overriding the OpenSSH executable search path</h2>

<p>On POSIX systems, Mutagen uses the first OpenSSH <code>ssh</code> and <code>scp</code> executables
that are found in the user&rsquo;s path. On Windows systems, Mutagen uses a different
approach described <a href="#windows">below</a>. Both of these search strategies can be
overridden by setting the <code>MUTAGEN_SSH_PATH</code> environment variable (for the
Mutagen daemon) to a path containing the desired OpenSSH executables.</p>

<h2 id="windows">Windows</h2>

<p>Windows is fully supported by Mutagen, though you&rsquo;ll need to bring your own
OpenSSH client. Unfortunately the
<a href="https://blogs.msdn.microsoft.com/powershell/2017/12/15/using-the-openssh-beta-in-windows-10-fall-creators-update-and-windows-server-1709/">official Windows OpenSSH client</a>
is still in beta and has a few blocking issues (primarily
<a href="https://github.com/PowerShell/Win32-OpenSSH/issues/1152">1152</a>) that disallow
its use by Mutagen at the moment. As soon as these issues are resolved, this
will become Mutagen&rsquo;s recommended client (though others will continue to be
supported).</p>

<p>Mutagen has a hardcoded set of OpenSSH clients that it will look for and use at
the moment, including those from
<a href="https://gitforwindows.org/">Git for Windows</a> (recommended),
<a href="http://www.msys2.org/">MSYS2</a>, and <a href="https://www.cygwin.com/">Cygwin</a>. You can
see the full list of search paths
<a href="https://github.com/havoc-io/mutagen/blob/fa4fa0dfe1aa35ec4c7a1c432593fd38191401da/pkg/ssh/ssh_windows.go#L13">here</a>.</p>

<p>One thing to be aware of is that the MSYS2 and Cygwin OpenSSH clients will, by
default, look for SSH configuration (<code>~/.ssh</code>) in the &ldquo;virtual&rdquo; home directory
provided by the underlying Cygwin environment. This is totally fine, though
Mutagen will continue to store its data (<code>~/.mutagen</code>) and look for its
configuration (<code>~/.mutagen.toml</code>) in the user&rsquo;s actual home directory (i.e. that
specified by <code>%USERPROFILE%</code>). The Git for Windows OpenSSH implementation will
look for SSH configuration in the actual home directory as well, which is why
Mutagen will give it priority if found.</p>

<h3 id="ssh-servers">SSH servers</h3>

<p>Mutagen is currently only known to work reliably with
<a href="https://www.bitvise.com/ssh-server">Bitvise SSH Server</a> on Windows.</p>

<p>The
<a href="https://blogs.msdn.microsoft.com/powershell/2017/12/15/using-the-openssh-beta-in-windows-10-fall-creators-update-and-windows-server-1709/">official Windows OpenSSH server</a>
is still in beta and has a few performance issues and other kinks that need to
be ironed out before Mutagen can reliably support it. Mutagen will connect to
this server and mostly work, but the performance is not great at the moment due
to the server&rsquo;s stream handling. Issues have also been experienced with stalled
data streams.</p>

<p>There is no reason that Mutagen won&rsquo;t work with other Windows SSH servers (e.g.
Cygwin&rsquo;s OpenSSH server), so please report your findings if you try them out.</p>

<h3 id="putty">PuTTY</h3>

<p>Mutagen does not support <a href="https://www.putty.org/">PuTTY</a>. I like PuTTY, and I
tried to implement this, but it doesn&rsquo;t seem like PuTTY provides comparable
mechanisms for forwarding prompts and streaming standard input/output. This
isn&rsquo;t too surprising, as the &ldquo;TTY&rdquo; in its name clearly aligns with its focus on
interactive terminal usage. I know that PuTTY is widely used, but I&rsquo;m hoping
that the offical Windows OpenSSH implementation will provide an easy migration
path in the very near future.</p>

        </div>
    </div>
</div>

        </div>
        <footer class="mt-auto">
            <div class="container py-3">
                <div class="row">
                    <div class="col-md-4 py-3 text-muted">
                        <strong>Copyright © 2016 – 2019 Jacob Howard.</strong><br />
                        All rights reserved.
                    </div>
                    <div class="col-md-2 offset-md-2 py-3">
                        <h4>Resources</h4>
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link active" href="/documentation">Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="https://groups.google.com/forum/#!forum/mutagen-announce">Announcements</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="https://groups.google.com/forum/#!forum/mutagen">Forums</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="https://github.com/havoc-io/mutagen/blob/master/SECURITY.md">Security</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-2 py-3">
                        <h4>Legal</h4>
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link active" href="/third-party-trademark-notices">Third-party trademarks</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-2 py-3">
                        <h4>Links</h4>
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link active" href="https://github.com/havoc-io/mutagen">GitHub</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="https://twitter.com/mutagen_io">Twitter</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="#">Top of page <i class="fas fa-caret-up"></i></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer>
    </body>
</html>
